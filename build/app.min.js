(function(t,e,n){var i=e.Appify={};i.Application=function(){};var r=function(e,n){var i,r=this;i=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return r.apply(this,arguments)},t.extend(i,r,n);var s=function(){this.constructor=i};return s.prototype=r.prototype,i.prototype=new s,e&&t.extend(i.prototype,e),i},s=i.Event={on:function(t,e){this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);n.push({callback:e,name:t})},off:{},trigger:function(e){var n=Array.prototype.slice.call(arguments,1);t.each(e,function(t,e){e.callback.apply(this,n)})},triggerEvent:function(t){if(!this._events)return this;var e=this._events[t];e&&this.trigger(e);var n=this._events.all;n&&this.trigger(n)}},o=i.Model=function(e){var n=this,i={attributes:{},events:{}};t.extend(this,i,e,s);var r=e||{};this.set(r),t.each(this.events,function(t,e){n.on(t,e)})};o.prototype={get:function(t){return this.attributes[t]},set:function(e,n){if(null===e)return this;var i,r=this;return"object"==typeof e?i=e:(i={},i[e]=n),t.extend(this.attributes,i),t.extend(this,i),t.each(i,function(t){r.triggerEvent(t)}),this}},o.extend=r;var a=i.Collection=function(e){var n=this,i={contents:[],events:[]};t.extend(this,i,e,s),t.each(this.events,function(t,e){n.on(t,e)})};a.prototype={add:function(t){this.contents.push(t),this.triggerEvent("add")},remove:function(t){var e=this.contents.splice(this.contents.indexOf(t),1)[0];return this.triggerEvent("remove"),e}};var c=i.View=function(e){var n=this,i={el:"div",className:"",id:"",events:[],template:function(){return _getSource()}};t.extend(this,i,e,s),this.$el=t("<"+this.el+' class="'+this.className+'" id="'+this.id+'"></'+this.el+">"),t.each(this.events,function(t,e){var i=t.split(" "),r=i[0],s=i.slice(1).join(" ");""===s?n.$el.on(r,e):n.$el.on(r,s,e)})};c.prototype={render:function(t){return this.$el.html(this.template(t)),this},getSource:function(){return this.source=this._findTemplateFromHTML(this.templateName).html(),this.source},_findTemplateFromHTML:function(e){return t('script[type="text/xx-appify"][data-template-name="'+e+'"]')}},i.controllers={},i.Controller=function(e){t.extend(this,e),i.controllers[e.name]=this};var h=i.Router=function(i){var r={routingTable:{}};t.extend(this,r,i);var s=this;t(n).on("click",'a:not([href^="http"])',function(e){e.preventDefault();var i=t(this).attr("href"),r=t(this).data("title");s.action(r,i),console.log(i),n.location.href.match("^http")&&"function"==typeof history.pushState&&history.pushState({},r,i)}),e.onpopstate&&(e.onpopstate=action(event))};h.prototype={action:function(t,e){var n=this.routingTable[e].split("#"),r=i.controllers[n[0]],s=r[n[1]];s.apply(r)}}})(jQuery,this,document);